### Source:Christiaan Heij, Paul de Boer, Philip Hans Franses, Teun Kloek, ###
### Herman K. van Dijk (2004).Econometric Methods with Applications in     ###
### Business and Economics. Oxford University Press                        ###

fgpa<- c(1.8, 2.4, 2.9, 3.0,3.5)
satm<- c(4,6, 6, 7, 8)
satv<- c(4, 5, 7, 6, 7)
y<- fgpa
con<- c(1, 1, 1, 1, 1)
X<- cbind(con, satm, satv)
X
 con satm satv
[1,]   1    4    4
[2,]   1    6    5
[3,]   1    6    7
[4,]   1    7    6
[5,]   1    8    7

X_t<- t(X)
X_t
 [,1] [,2] [,3] [,4] [,5]
con     1    1    1    1    1
satm    4    6    6    7    8
satv    4    5    7    6    7
X_t%*%y
[,1]
con  13.6
satm 88.0
satv 82.0

solve(X_t%*%X)
 con       satm       satv
con   5.4112150 -0.2897196 -0.5887850
satm -0.2897196  0.3177570 -0.2897196
satv -0.5887850 -0.2897196  0.4112150

eigen(X_t%*%X) 
eigen() decomposition
$values
[1] 379.2684617   1.5494607   0.1820776
$vectors
           [,1]        [,2]        [,3]
[1,] -0.1126985  0.04812947  0.99246290
[2,] -0.7266693 -0.68521715 -0.04928686
[3,] -0.6776805  0.72674687 -0.11219713

B<- solve(X_t%*%X)
P<- X%*%B%*%X_t
P
 [,1]       [,2]        [,3]        [,4]       [,5]
[1,]  0.77570093  0.3177570  0.11214953  0.03738318 -0.2429907
[2,]  0.31775701  0.3831776 -0.15887850  0.28037383  0.1775701
[3,]  0.11214953 -0.1588785  0.94392523 -0.01869159  0.1214953
[4,]  0.03738318  0.2803738 -0.01869159  0.32710280  0.3738318
[5,] -0.24299065  0.1775701  0.12149533  0.37383178  0.5700935

P%*%X
 con satm satv
[1,]   1    4    4
[2,]   1    6    5
[3,]   1    6    7
[4,]   1    7    6
[5,]   1    8    7


k1<- c(-0.08169, -0.84091,0.24880)
k2<- c(-0.53396,-0.29451,0.10645)
k3<- c(0.42535, 0.08260, 0.86959)
k4<- c(-0.52027, 0.07297, 0.22606)
k5<- c(-0.50657, 0.44045, 0.34566)
K<- cbind(k1, k2, k3, k4, k5)
K_t<- t(K)
K_t%*%K 
(K_t%*%K)%*%X


 
eigen(P)
eigen() decomposition
$values
[1] 1.000000e+00 1.000000e+00 1.000000e+00 3.864889e-15 1.679655e-15

$vectors
            [,1]       [,2]       [,3]       [,4]        [,5]
[1,]  0.25108135  0.8115711 -0.2324037  0.3230985 -0.34627503
[2,]  0.43634357  0.1370914 -0.4171185 -0.1592315  0.76906940
[3,] -0.83788192  0.2820306 -0.4029117 -0.1615493  0.17313751
[4,]  0.21041831 -0.1639136 -0.5059242 -0.6508325 -0.49931372
[5,] -0.01550696 -0.4649187 -0.5947299  0.6485148 -0.09661817

v1<- c(0.25108135, 0.43634357,-0.83788192, 0.21041831, -0.01550696)
v2<- c(0.8115711,0.1370914, 0.2820306, -0.1639136, -0.4649187)
v3<- c(-0.2324037, -0.4171185,-0.4029117, -0.5059242,-0.5947299)
v4<- c(0.3230985, -0.1592315,-0.1615493, -0.6508325,0.6485148)
v5<- c(-0.34627503 , 0.76906940, 0.17313751, -0.49931372,-0.09661817)
V<- cbind(v1,v2,v3,v4,v5)
V
V_t<- t(V)
d1<- c(1,0,0,0,0)
d2<- c(0,1,0,0,0)
d3<- c(0,0,1,0,0)
d4<- c(0,0,0,3.864889e-15,0)
d5<- c(0,0,0,0,1.679655e-15)
D<- cbind(d1,d2,d3,d4,d5)
V_t<- t(V)
A<- V%*%D%*%V_t
A
A_t<- t(A)
### impodent ###
A_t%*%A
### A is projection matrix A=P ###
P








a<- X_t%*%X
eigen(a)
eigen() decomposition
$values
[1] 379.2684617   1.5494607   0.1820776

$vectors
           [,1]        [,2]        [,3]
[1,] -0.1126985  0.04812947  0.99246290
[2,] -0.7266693 -0.68521715 -0.04928686
[3,] -0.6776805  0.72674687 -0.11219713

lam1<- c(379.2684617, 0, 0)
lam2<- c(0,    1.5494607 ,0)
lam3<- c(0,0,   0.1820776)
D1<- cbind(lam1,lam2,lam3)


v11<- c( -0.1126985 , -0.7266693 ,-0.6776805)
V22<- c(0.04812947, -0.68521715, 0.72674687)
v33<- c( 0.99246290 , -0.04928686, -0.11219713)
V1<- cbind(v11,v22,v33)
V1_t<- t(V1)
V1%*%D1%*%V1_t
 [,1]      [,2]      [,3]
[1,]  5.814604  31.82263  29.00131
[2,] 31.822627 201.00000 186.82394
[3,] 29.001308 186.82394 174.18542
> 


